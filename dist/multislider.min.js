/*
 *  multi-slider - v0.1.0
 *  A multi-slider bar jQuery plugin.
 *  http://components.rmalabs.com/multi-slider
 *
 *  Made by Harun Hasdal
 *  Under MIT License
 */
!function(a,b,c){"use strict";function d(b,c){this.element=a(b),this.settings=a.extend({},g,c),this.state={},this.init()}function e(a){return Number(a).toFixed(1)+"%"}var f="multiSlider",g={},h="ontouchstart"in b;a.extend(d.prototype,{init:function(){var b=a('<div class="bucket-collection"></div>');for(var c in this.settings.buckets)b.append(a("<div></div>").addClass(this.settings.buckets[c].key).addClass("bucket").append("<span>"+this.settings.buckets[c].value+"%</span>").css("height",this.settings.buckets[c].value+"%").append('<div class="handle"></div>'));h&&this.element.addClass("touch-enabled"),this.element.addClass("multibar-slider").append(b),this.bucketList=b,this.addDragHandlers()},setDraggingState:function(b,c){this.state.bucketEl=a(b.parentElement),this.state.neigbourEl=this.state.bucketEl.next(),this.state.totalHeight=this.element.outerHeight(),this.state.bucketInitialHeight=this.state.bucketEl.outerHeight()/this.state.totalHeight,this.state.neighbourInitialHeight=this.state.neigbourEl.outerHeight()/this.state.totalHeight,this.state.startPoint=c},startDragging:function(){this.bucketList.addClass("dragging"),this.state.bucketEl.addClass("active")},endDragging:function(){this.bucketList.removeClass("dragging"),this.state.bucketEl.removeClass("active"),this.state={totalHeight:this.state.totalHeight}},executeDrag:function(a){var b=(a.y-this.state.startPoint.y)/this.state.totalHeight,c=e(100*(this.state.bucketInitialHeight+b));this.state.bucketEl.css("height",c).find("span").html(c);var d=e(100*(this.state.neighbourInitialHeight-b));this.state.neigbourEl.css("height",d).find("span").html(d)},addDragHandlers:function(){var b=a(c.body),d=this.element.find(".handle");d.on("mousedown",function(a){this.setDraggingState(a.target,{y:a.pageY}),b.on("mousemove",function(a){this.executeDrag({y:a.pageY})}.bind(this)),b.on("mouseup",function(){b.unbind("mousemove"),b.unbind("mouseup"),this.endDragging()}.bind(this)),this.startDragging()}.bind(this)),h&&d.on("touchstart",function(a){var c=a.originalEvent.touches[0];this.setDraggingState(c.target,{y:c.pageY}),b.on("touchmove",function(a){a.preventDefault(),a.stopPropagation(),this.executeDrag({y:a.originalEvent.touches[0].pageY})}.bind(this)),b.on("touchend",function(){b.unbind("touchmove"),b.unbind("touchend"),this.endDragging()}.bind(this)),this.startDragging()}.bind(this))}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new d(this,b))})}}(jQuery,window,document);